<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Lost & Found - LOST NEEDS</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <link rel="icon" href="img/LOSTNEEDS.png">
<script src="https://cdnjs.cloudflare.com/ajax/libs/amazon-cognito-identity-js/6.2.1/amazon-cognito-identity.min.js"></script>
<script src="js/auth.js"></script>

  <style>
    @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500&display=swap');
    *{box-sizing:border-box;margin:0;padding:0;font-family:'Poppins',sans-serif}

    body{padding-top:75px;background:#f5f8fb;}

    /* HEADER */
    .header{
      position:fixed;top:0;left:0;width:100%;height:65px;
      background:#3498db;color:#fff;
      display:flex;align-items:center;justify-content:space-between;
      padding:10px 20px;z-index:100;
    }

    /* MAIN CONTAINER */
    .container{
      max-width:1100px;margin:30px auto;
      padding:20px;background:#fff;border-radius:10px;
      box-shadow:0 4px 10px rgba(0,0,0,0.1);
    }

    h2{margin-bottom:12px;color:#0066a1;}

    /* Filters */
    .filters{
      display:flex;gap:10px;margin-bottom:15px;
    }

    select,button{
      padding:10px;border-radius:6px;
      border:1px solid #ccc;font-size:15px;
    }

    button{
      background:#3498db;color:white;border:none;cursor:pointer;
    }

    /* Table */
    table{width:100%;border-collapse:collapse;margin-top:10px;}
    th,td{border:1px solid #ddd;padding:9px;font-size:14px;}
    th{background:#3498db;color:white;}

    img.thumb{
      height:60px;width:60px;object-fit:cover;border-radius:6px;
    }
  </style>
</head>
<body>

  <!-- HEADER -->
  <div class="header">
    <div style="display:flex;align-items:center;">
      <img src="img/Lostneeds2.png" height="40" alt="">
      <strong style="margin-left:10px">LOST NEEDS</strong>
    </div>
    <nav>
      <a href="post.html" style="color:#fff;text-decoration:none;font-weight:500;">Post</a>
    </nav>
  </div>

  <!-- MAIN AREA -->
  <main class="container">
    <h2>Lost & Found Reports</h2>

    <div class="filters">
      <select id="categoryFilter">
        <option value="">All</option>
        <option value="mobile">Mobile Phones</option>
        <option value="wallet">Wallets</option>
        <option value="keys">Keys</option>
        <option value="bags">Bags</option>
        <option value="documents">Documents</option>
      </select>

      <button id="refreshBtn">Refresh</button>
    </div>

    <!-- Table is loaded here -->
    <div id="tableArea">Loading...</div>
  </main>

  <!-- App JS -->
  <script type="module">
    import { getReports } from "./js/app.js";

    const cat = document.getElementById("categoryFilter");
    const tableArea = document.getElementById("tableArea");

    document.getElementById("refreshBtn").addEventListener("click", loadReports);

    // RENDER REPORT TABLE
    async function renderReportsList(filter) {
      tableArea.innerHTML = "Loading...";

      try {
        const items = await getReports();
        const rows = items.filter(
          row => !filter || row.category === filter
        );

        if (!rows.length) {
          tableArea.innerHTML = "<p>No results found.</p>";
          return;
        }

        let html = `
        <table>
          <thead>
            <tr>
              <th>Image</th>
              <th>Title</th>
              <th>Category</th>
              <th>Date</th>
              <th>Location</th>
              <th>Type</th>
              <th>Owner</th>
            </tr>
          </thead>
          <tbody>
        `;

        for (const r of rows) {
          html += `
          <tr>
            <td>${r.imageUrl ? `<img class="thumb" src="${r.imageUrl}">` : ""}</td>
            <td>${r.title || ""}</td>
            <td>${r.category || ""}</td>
            <td>${r.date || ""} ${r.time || ""}</td>
            <td>${r.location || ""}</td>
            <td>${r.postType || ""}</td>
            <td>${r.ownerName || r.ownerEmail || ""}</td>
          </tr>`;
        }

        html += "</tbody></table>";

        tableArea.innerHTML = html;

      } catch (err) {
        console.error(err);
        tableArea.innerHTML = "<p style='color:red'>Error loading reports</p>";
      }
    }

    async function loadReports() {
      renderReportsList(cat.value);
    }

    // load initially
    loadReports();
  </script>

</body>
</html>
